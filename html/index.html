<!doctype html>
<html lang="fr" xml:lang="fr" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title>Orinoco nouveau site de vente en ligne par catégories</title>
    <meta name="description" content="Site de vente en ligne qui vous permet de choisir la catégorie d'articles qui vous intéresse afin qu'on ne vous présente pas d'articles non pertinents">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <link rel="shortcut icon" type="image/png" href="../img/favicon.jpg" >
	  <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Merienda:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
    <script src="../js/main.js" defer> </script>
</head>

<body>
  <header>
  <div class="hautdepage">
    <img src="../img/logo.png" alt="logo d'Orinoco"/>
    <h1>Orinoco</h1>
  </div>
  		<nav>
        <ul class="row">
          <li class="hautdepage__btn"><a href="index.html">NOS PRODUITS &ensp;</a>
             <ul class="hautdepage__btn__deroulant">
               <li><a href="index.html">Ours en peluche</a></li>
               <li>Caméras</li>
               <li>Meubles en chêne</li>
             </ul>
           </li>
           <li id="commande" class="hautdepage__btn dropdown"><a href="panier.html#panier">PANIER &ensp;</a>
            <div id="panier_style" class="tourni">
              <table id="panier">
             </table>
            </div>
          </li>
       </ul>
     </nav>
  </header>
    <div id="bears">
    </div>

  <footer>

  </footer>

  <script >
  //chargement de la liste des produits après chargement de la page
    window.addEventListener("load", function(){
      /**
        * @brief méthode permettant de charger les produits du catalogue
        * @return une promesse qui résolue renverra le nombre de pdts récupérés
        */
        let url1="http://localhost:3000/api/teddies/";
        let load = async function(){
          const response = await fetch(url1);
          return response.json();
        };
        let promise=load();
        promise.then(function(listeOurs){
        //insert dans la page chaque produit renvoyé par le catalogue
        for (let i=0; i<listeOurs.length;i++){
          //let ours =Produits.get(i);
          let ours=listeOurs[i];

          //création d'un élément conteneur pour l'un des produits
          let bears = document.getElementById("bears");
          let new_bear=document.createElement('div');
          new_bear.setAttribute("class","bear");
          bears.appendChild(new_bear);

          //création d'un élément titre pour le nom de l'ours
          let new_titre=document.createElement('h2');
          new_titre.innerHTML="Ours en peluche "+ours.name;
          new_bear.appendChild(new_titre);

          //création d'un élément structurant contenant les éléments du produit
          let new_produit=document.createElement('div');
          new_produit.setAttribute("class","produit");
          new_bear.appendChild(new_produit);
          //création d'un élément structurant contenant image
          let new_cadre_img=document.createElement('div');
          new_cadre_img.setAttribute("class", "cadre-img");
          new_produit.appendChild(new_cadre_img);
          //création d'un élément structurant contenant prix et description
          let new_cadre_pdt=document.createElement('div');
          new_cadre_pdt.setAttribute("class", "cadre-pdt");
          new_produit.appendChild(new_cadre_pdt);

          //création d'un élément avec l'image du produit et lien vers fiche
          let new_img=document.createElement('a');
          new_img.setAttribute("href","perso.html?product_id="+ours._id);
          new_cadre_img.appendChild(new_img);
          let new_source=document.createElement("img");
          new_source.setAttribute("src",ours.imageUrl);
          new_img.appendChild(new_source);

          //création d'un élément contenant la description du produit
          let new_description=document.createElement('p')
          new_cadre_pdt.appendChild(new_description);
          new_description.innerHTML=ours.description;

          //création d'un élément contenant le prix du produit
          let new_prix=document.createElement('div');
          new_prix.setAttribute("class", "prix");
          new_cadre_pdt.appendChild(new_prix);
          new_prix.innerHTML="Prix : "+ours.price+"&nbsp;&euro;";
          }
        });
      });
  </script>

</body>
</html>
